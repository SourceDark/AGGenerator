package org.serc.controller;

import java.util.Optional;

import org.serc.model.CveEntry;
import org.serc.repository.CveEntryRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Pageable;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.google.common.collect.Lists;

@RestController
public class CveController {
    
    @Autowired
    private CveEntryRepository cveEntryRepository;
    
    @GetMapping("")
    public Object getCves(Pageable pageable, @RequestParam Optional<String> filter) {
        if(filter.isPresent()) {
            return cveEntryRepository.findByIdIn(Lists.newArrayList(filter.get().split(",")));
        }
        return cveEntryRepository.findAll(pageable);
    }
    
    @GetMapping("/{id}")
    public CveEntry getCve(@PathVariable String id) {
        return cveEntryRepository.findOne(id);
    }

}
